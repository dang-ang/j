<!DOCTYPE html>
<html lang="it">
<head>
    <meta Content-Type="text/html">
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>Web App Form</title>

</head>
<body>
  <h1>Submit Data to Google Sheets</h1>
  <form id="submitForm">
    <label for="name">Name:</label><br>
    <input type="text" id="name" name="name"><br>
    <label for="email">Email:</label><br>
    <input type="email" id="email" name="email"><br>
    <label for="rpe">RPE:</label><br>
    <input type="text" id="rpe" name="rpe"><br>
    <label for="message">Message:</label><br>
    <textarea id="message" name="message"></textarea><br>
    <input type="submit" value="Submit">
  </form>

  <script>
    document.getElementById("submitForm").addEventListener("submit", function(event) {
      event.preventDefault();
      submitForm();
    });

    function submitForm() {
      const formData = {
        name: document.getElementById("name").value,
        email: document.getElementById("email").value,
        rpe: document.getElementById("rpe").value,
        message: document.getElementById("message").value
      };

 // write_google => su sheets : 'Sheet1'
 // const scriptURL = 'https://script.google.com/macros/s/AKfycbwssqh4NY-GP7uxNsx7lqBrS5QpiE-GSYgY5uTh9uhfCHm3r0NXLvN6ci693VSYDaWkow/exec'; // write_google.xlsx   .... Inserisci qui l'URL del tuo Web App
 // write su rpe_tqr : 2526     
 fetch("https://script.google.com/macros/s/AKfycbxoXC2KT-8dPYE_q47WHANaPHBVBdumNbVMvqkD2EWC8naS-gYrvgrBdzMdIckctFjjUQ/exec", {
        method: "POST",
        body: JSON.stringify(formData)
      })
      .then(response => response.text())
      .then(data => {
        alert(data);
        document.getElementById("submitForm").reset();
      })
      .catch(error => console.error("Error:", error));
    }
  </script>
</body>
</html>
